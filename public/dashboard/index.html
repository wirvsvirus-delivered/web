<!DOCTYPE html>
<html lang="de" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>delivered Dashboard</title>
  <link href="img/favicon.png" rel="shortcut icon">
  <link rel="stylesheet" href="css/master.css">
</head>

<body>

  <div class="loader-wrapper" style="display: flex;">
    <div class="loader"></div>
  </div>
  <div class="modal-wrapper modal-newEntry-wrapper">
    <div class="modal modal-newEntry">
      <h2 class="heading">Neuer Eintrag
        <button style="border-radius: 50%; padding: 4px;float: right; background:#ab1c48" onclick="$('.modal-newEntry-wrapper').hide();">
          <i class="material-icons md-18">highlight_off</i>
        </button>
      </h2>
      <form class="form-newEntry">
        <input required type="text" name="fname" placeholder="Vorname">
        <input required type="text" name="lname" placeholder="Nachname">
        <input required type="tel" name="tel" placeholder="Telefonnummer">
        <input required type="number" name="zip" placeholder="PLZ">
        <div class="row">
          <input style="width:70%" required type="text" name="street" placeholder="Stra&szlig;e">
          <input style="width:25%" required type="text" name="num" placeholder="Hausnr.">
        </div>
        <input type="text" name="adressInfo" placeholder="Zus&auml;tzliche Adressinfo">
        <section style="margin-top:10px;">Altersbeschr&auml;nkung<br>
          <input required type="radio" name="age" value="18" id="volljaehrig">&nbsp;
          <label for="volljaehrig">Ab 16</label><br>
          <input required type="radio" name="age" value"16" id="sechzehn">&nbsp;
          <label for="sechzehn">Ab 18</label><br>
          <input required type="radio" name="age" value"0" id="keine">&nbsp;
          <label for="keine">Keine</label><br>
        </section>
        <input required type="datetime" name="data" placeholder="Data">
        <button type="submit">Absenden <i class="material-icons md-18">send</i></button>
      </form>
    </div>
  </div>
  <div class="modal-wrapper modal-showEntry-wrapper">
    <div class="modal modal-showEntry">
      <h2 class="heading">Eintrag anzeigen
        <button style="border-radius: 50%; padding: 4px;float: right; background:#ab1c48" onclick="$('.modal-showEntry-wrapper').hide();">
          <i class="material-icons md-18">highlight_off</i>
        </button>
      </h2>
      <form class="form-newEntry">
        <input required type="text" name="fname" placeholder="Vorname">
        <input required type="text" name="lname" placeholder="Nachname">
        <input required type="number" name="zip" placeholder="PLZ">
        <button type="submit">&Ouml;ffnen <i class="material-icons md-18">launch</i></button>
      </form>
    </div>
  </div>
  <div class="dashboard-wrapper">
    <div class="dashboard">
      <div class="dashboard-topbar">
        <div class="dashboard-topbar-brand heading"><img src="img/icon.png" alt="delivered"> &nbsp;Dashboard</div>
        <ul class="dashboard-topbar-actions">
          <li>
            <button onclick="signOut()" style="background:#ab1c48">
              <i class="material-icons md-18">exit_to_app</i>
              Abmelden
            </button>
          </li>
        </ul>
      </div>
      <div class="dashboard-body">
        <h1 class="heading" style="padding-top: 40px;">Auftr&auml;ge</h1>
        <div class="dashboard-body-button-wrapper">
          <div>
            <button onclick="$('.modal-showEntry-wrapper').css('display', 'flex')">
              <i class="material-icons">visibility</i>
              <span>Auftrag anzeigen</span>
            </button>
          </div>
          <div>
            <button>
              <i class="material-icons">create</i>
              <span>Auftrag bearbeiten</span>
            </button>
          </div>
          <div>
            <button>
              <i class="material-icons">delete_outline</i>
              <span>Auftrag l&ouml;schen</span>
            </button>
          </div>
          <div>
            <button onclick="$('.modal-newEntry-wrapper').css('display', 'flex');">
              <i class="material-icons">add</i>
              <span>Neuer Auftrag</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/__/firebase/7.12.0/firebase-app.js"></script>
  <script src="/__/firebase/7.12.0/firebase-auth.js"></script>
  <script src="/__/firebase/7.12.0/firebase-firestore.js"></script>
  <script src="/__/firebase/7.12.0/firebase-functions.js"></script>
  <script src="/__/firebase/init.js"></script>
  <script src="js/jquery.js"></script>
  <script>
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        var db = firebase.firestore();
        var docRef = db.collection("users").doc(user.uid);
        docRef.get().then(function(doc) {
          if (doc.exists) {
            if (doc.data().type === 'telephoner') {
              $('.loader-wrapper').hide();
            } else {
              alert('Du bist kein registrierter Telefonist!');
              signOut();
              window.location.replace('/dashboard/auth/');
            }
          } else {
            console.log("No such document!");
            signOut();
            window.location.replace('/dashboard/auth/');
          }
        }).catch(function(error) {
          console.log("Error getting document:", error);
        });
      } else {
        window.location.replace('/dashboard/auth/');
      }
    });

    function signOut() {
      firebase.auth().signOut().then(function() {
        window.location.replace('/dashboard/auth/');
      });
    }
  </script>

</body>

</html>
